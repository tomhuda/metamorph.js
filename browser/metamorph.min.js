(function(e){"use strict";var t=function(){},n=0,r=window.document,i="createRange"in r&&typeof Range!="undefined"&&Range.prototype.createContextualFragment,s=function(){var e=r.createElement("div");return e.innerHTML="<div></div>",e.firstChild.innerHTML="<script></script>",e.firstChild.innerHTML===""}(),o=function(){var e=r.createElement("div");return e.innerHTML="Test: <script type='text/x-placeholder'></script>Value",e.childNodes[0].nodeValue==="Test:"&&e.childNodes[2].nodeValue===" Value"}(),u=function(e){var r;this instanceof u?r=this:r=new t,r.innerHTML=e;var i="metamorph-"+n++;return r.start=i+"-start",r.end=i+"-end",r};t.prototype=u.prototype;var a,f,l,c,h,p,d,v,m;c=function(){return this.startTag()+this.innerHTML+this.endTag()},v=function(){return"<script id='"+this.start+"' type='text/x-placeholder'></script>"},m=function(){return"<script id='"+this.end+"' type='text/x-placeholder'></script>"};if(i)a=function(e,t){var n=r.createRange(),i=r.getElementById(e.start),s=r.getElementById(e.end);return t?(n.setStartBefore(i),n.setEndAfter(s)):(n.setStartAfter(i),n.setEndBefore(s)),n},f=function(e,t){var n=a(this,t);n.deleteContents();var r=n.createContextualFragment(e);n.insertNode(r)},l=function(){var e=a(this,!0);e.deleteContents()},h=function(e){var t=r.createRange();t.setStart(e),t.collapse(!1);var n=t.createContextualFragment(this.outerHTML());e.appendChild(n)},p=function(e){var t=r.createRange(),n=r.getElementById(this.end);t.setStartAfter(n),t.setEndAfter(n);var i=t.createContextualFragment(e);t.insertNode(i)},d=function(e){var t=r.createRange(),n=r.getElementById(this.start);t.setStartAfter(n),t.setEndAfter(n);var i=t.createContextualFragment(e);t.insertNode(i)};else{var g={select:[1,"<select multiple='multiple'>","</select>"],fieldset:[1,"<fieldset>","</fieldset>"],table:[1,"<table>","</table>"],tbody:[2,"<table><tbody>","</tbody></table>"],tr:[3,"<table><tbody><tr>","</tr></tbody></table>"],colgroup:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],map:[1,"<map>","</map>"],_default:[0,"",""]},y=function(e,t){if(e.getAttribute("id")===t)return e;var n=e.childNodes.length,r,i,s;for(r=0;r<n;r++){i=e.childNodes[r],s=i.nodeType===1&&y(i,t);if(s)return s}},b=function(e,t){var n=[];o&&(t=t.replace(/(\s+)(<script id='([^']+)')/g,function(e,t,r,i){return n.push([i,t]),r})),e.innerHTML=t;if(n.length>0){var i=n.length,s;for(s=0;s<i;s++){var u=y(e,n[s][0]),a=r.createTextNode(n[s][1]);u.parentNode.insertBefore(a,u)}}},w=function(e,t){var n=g[e.tagName.toLowerCase()]||g._default,i=n[0],o=n[1],u=n[2];s&&(t="&shy;"+t);var a=r.createElement("div");b(a,o+t+u);for(var f=0;f<=i;f++)a=a.firstChild;if(s){var l=a;while(l.nodeType===1&&!l.nodeName)l=l.firstChild;l.nodeType===3&&l.nodeValue.charAt(0)==="Â­"&&(l.nodeValue=l.nodeValue.slice(1))}return a},E=function(e){while(e.parentNode.tagName==="")e=e.parentNode;return e},S=function(e,t){e.parentNode!==t.parentNode&&t.parentNode.insertBefore(e,t.parentNode.firstChild)};f=function(e,t){var n=E(r.getElementById(this.start)),i=r.getElementById(this.end),s=i.parentNode,o,u,a;S(n,i),o=n.nextSibling;while(o){u=o.nextSibling,a=o===i;if(a){if(!t)break;i=o.nextSibling}o.parentNode.removeChild(o);if(a)break;o=u}o=w(n.parentNode,e);while(o)u=o.nextSibling,s.insertBefore(o,i),o=u},l=function(){var e=E(r.getElementById(this.start)),t=r.getElementById(this.end);this.html(""),e.parentNode.removeChild(e),t.parentNode.removeChild(t)},h=function(e){var t=w(e,this.outerHTML()),n;while(t)n=t.nextSibling,e.appendChild(t),t=n},p=function(e){var t=r.getElementById(this.end),n=t.nextSibling,i=t.parentNode,s,o;o=w(i,e);while(o)s=o.nextSibling,i.insertBefore(o,n),o=s},d=function(e){var t=r.getElementById(this.start),n=t.parentNode,i,s;s=w(n,e);var o=t.nextSibling;while(s)i=s.nextSibling,n.insertBefore(s,o),s=i}}u.prototype.html=function(e){this.checkRemoved();if(e===undefined)return this.innerHTML;f.call(this,e),this.innerHTML=e},u.prototype.replaceWith=function(e){this.checkRemoved(),f.call(this,e,!0)},u.prototype.remove=l,u.prototype.outerHTML=c,u.prototype.appendTo=h,u.prototype.after=p,u.prototype.prepend=d,u.prototype.startTag=v,u.prototype.endTag=m,u.prototype.isRemoved=function(){var e=r.getElementById(this.start),t=r.getElementById(this.end);return!e||!t},u.prototype.checkRemoved=function(){if(this.isRemoved())throw new Error("Cannot perform operations on a Metamorph that is not in the DOM.")},e.Metamorph=u})(window);
